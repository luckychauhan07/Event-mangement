<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Event Ease â€” Reply to Notification</title>

  <!-- Fonts + Bootstrap -->
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <!-- Bootstrap Icons -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
  />
  <!-- Shared styles -->
  <link rel="stylesheet" href="../style.css" />
</head>
<body>
  <!-- TOPBAR -->
  <header class="topbar">
    <a class="d-flex align-items-center text-decoration-none" href="sc-dashboard.html">
      <div class="logo-mark">EE</div>
      <div style="margin-left: 10px; font-weight: 700; color: var(--text-dark);">
        Event Ease
      </div>
    </a>

    <div class="d-flex align-items-center gap-3">
      <!-- User dropdown only -->
      <div class="dropdown">
        <button class="btn d-flex align-items-center gap-2" data-bs-toggle="dropdown">
          <div
            class="rounded-circle bg-primary text-white"
            style="width: 36px; height: 36px; display: grid; place-items: center;"
          >
            SC
          </div>
          <div class="d-none d-md-block text-start">
            <div style="font-weight: 600;">Student Coord</div>
            <div class="small muted">you@college.edu</div>
          </div>
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><a class="dropdown-item" href="sc-profile.html">Profile</a></li>
          <li><hr class="dropdown-divider" /></li>
          <li><button class="dropdown-item text-danger" id="scLogoutTop">Logout</button></li>
        </ul>
      </div>
    </div>
  </header>

  <div class="app-shell">
    <!-- SIDEBAR -->
    <aside class="app-sidebar d-none d-lg-flex">
      <nav class="sidebar-nav">
        <a href="sc-dashboard.html">ğŸ  Dashboard</a>
        <a href="sc-events.html">ğŸ“… My Events</a>
        <a href="sc-teams.html">ğŸ‘¥ Manage Teams</a>
        <a href="sc-participants.html">ğŸ“‹ Participants</a>
        <a href="sc-notifications.html">
          ğŸ”” Notifications
          <span class="badge bg-light text-primary ms-1" id="scNotifCountBadge">3</span>
        </a>
      </nav>
    </aside>

    <!-- MAIN -->
    <main class="app-main">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
          <h4 class="mb-0">Reply to notification</h4>
          <div class="muted" id="replyContext">
            Reply to the sender of this notification.
          </div>
        </div>
        <div class="d-flex gap-2">
          <button type="button" id="btnBack" class="btn btn-outline btn-sm">
            â† Back
          </button>
        </div>
      </div>

      <div class="card-compact">
        <form id="replyForm" class="row g-3 needs-validation" novalidate>
          <div class="col-12 col-md-6">
            <label class="form-label">From</label>
            <input
              id="replyFrom"
              class="form-control"
              value="Student Coordinator"
              disabled
            />
          </div>

          <div class="col-12 col-md-6">
            <label class="form-label">To</label>
            <input
              id="replyTo"
              class="form-control"
              disabled
            />
          </div>

          <div class="col-12">
            <label class="form-label">Subject</label>
            <input
              id="replySubject"
              class="form-control"
              placeholder="Re: "
            />
          </div>

          <div class="col-12">
            <label class="form-label">Message</label>
            <textarea
              id="replyMessage"
              class="form-control"
              rows="5"
              required
              placeholder="Type your reply to this notification"
            ></textarea>
            <div class="invalid-feedback">Please enter a reply message.</div>
          </div>

          <div class="col-12 d-flex justify-content-between align-items-center mt-2">
            <div class="muted small">
              This reply will be visible to the original sender in the final system.
            </div>
            <div class="d-flex gap-2">
              <button type="button" id="btnCancel" class="btn btn-outline btn-sm">
                Cancel
              </button>
              <button type="submit" class="btn btn-primary btn-sm">
                Send reply
              </button>
            </div>
          </div>
        </form>
      </div>
    </main>
  </div>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const SC_ID = "SC01";

    document.getElementById("scLogoutTop")?.addEventListener("click", () => {
      if (confirm("Logout from Student Coordinator account?")) {
        alert("Logged out.");
      }
    });

    const notifBadge = document.getElementById("scNotifCountBadge");
    if (notifBadge) notifBadge.textContent = "3";

    const params = new URLSearchParams(window.location.search); // [web:689]
    const notifId = params.get("notifId") || "";
    const toName = params.get("toName") || "Teacher Coordinator";
    const toRole = params.get("toRole") || "Teacher Coordinator";
    const subjectBase = params.get("subject") || "Notification";

    const replyToInput = document.getElementById("replyTo");
    const replySubjectInput = document.getElementById("replySubject");
    const replyContext = document.getElementById("replyContext");
    const replyForm = document.getElementById("replyForm");
    const replyMessage = document.getElementById("replyMessage");
    const btnBack = document.getElementById("btnBack");
    const btnCancel = document.getElementById("btnCancel");

    // Prefill context and fields
    replyToInput.value = toName + " (" + toRole + ")";
    replySubjectInput.value = "Re: " + subjectBase;
    replyContext.textContent = notifId
      ? `Replying to notification ${notifId} sent by ${toName}.`
      : `Replying to ${toName}.`;

    // Back / Cancel -> go back to notifications list or previous page
    function goBack() {
      if (document.referrer) {
        window.history.back();
      } else {
        window.location.href = "sc-notifications.html";
      }
    }

    btnBack.addEventListener("click", goBack);
    btnCancel.addEventListener("click", goBack);

    replyForm.addEventListener("submit", evt => {
      evt.preventDefault();
      evt.stopPropagation();

      if (!replyForm.checkValidity()) {
        replyForm.classList.add("was-validated");
        return;
      }

      const message = replyMessage.value.trim();

      alert(
        "Reply sent with the following details:\n\n" +
        `To: ${replyToInput.value}\n` +
        `Subject: ${replySubjectInput.value}\n` +
        `Message:\n${message}\n\n` +
        "In the final system this would be stored and visible in the notification thread."
      ); // demo only[web:802]

      replyForm.reset();
      replyForm.classList.remove("was-validated");
      goBack();
    });
  </script>
</body>
</html>
