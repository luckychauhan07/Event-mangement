<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1" />
		<title>Add Event ‚Äî Event Ease</title>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<link rel="stylesheet" href="../style.css" />
		<link rel="stylesheet" href="admin-common.css" />
	</head>
	<body>
		<!-- TOPBAR -->
		<header class="topbar">
			<a
				class="d-flex align-items-center text-decoration-none"
				href="admin.html"
				aria-label="Event Ease Home"
			>
				<div class="logo"><img src="../logo.svg" alt="EE" /></div>
				<div
					style="
						margin-left: 10px;
						font-weight: 700;
						color: var(--text-dark);
					"
				>
					Event Ease
				</div>
			</a>
			<div class="d-flex align-items-center gap-3">
				<div class="d-none d-md-block" style="min-width: 280px">
					<input
						id="globalSearch"
						class="form-control form-control-sm"
						placeholder="Search (events, users, IDs) ‚Äî /"
					/>
				</div>
				<a
					href="notifications.html"
					class="position-relative btn btn-light"
					title="Notifications"
				>
					üîî
					<span
						id="adminNotifCount"
						class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
						style="font-size: 11px"
						>2</span
					>
				</a>
				<div class="dropdown">
					<button
						class="btn d-flex align-items-center gap-2"
						data-bs-toggle="dropdown"
						aria-expanded="false"
					>
						<div
							class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center"
							style="width: 36px; height: 36px"
						>
							AD
						</div>
						<div class="d-none d-md-block text-start">
							<div style="font-weight: 600">Admin</div>
							<div class="small muted">admin@college.edu</div>
						</div>
					</button>
					<ul class="dropdown-menu dropdown-menu-end">
						<li>
							<a class="dropdown-item" href="profile.html"
								>Profile</a
							>
						</li>
						<li>
							<a class="dropdown-item" href="settings.html"
								>Settings</a
							>
						</li>
						<li><hr class="dropdown-divider" /></li>
						<li>
							<a
								class="dropdown-item text-danger"
								href="#"
								id="logoutBtn"
								>Logout</a
							>
						</li>
					</ul>
				</div>
			</div>
		</header>

		<div class="app-shell">
			<!-- SIDEBAR -->
			<aside class="app-sidebar d-none d-lg-flex">
				<nav class="sidebar-nav">
					<a href="admin.html">üè† Home</a>
					<a href="users.html">üë• Users</a>
					<a href="events.html">üìÖ Events</a>
					<a class="active" href="add-event.html">‚ûï Add Event</a>
					<a href="reports.html">üìä Reports</a>
					<a href="notifications.html">üîî Notifications</a>
					<a href="profile.html">üë§ Profile</a>
				</nav>
				<div class="sidebar-footer">
					<a
						id="logoutSide"
						class="text-danger"
						style="display: block; margin-bottom: 12px"
						>üîí Logout</a
					>
					v1.0 ‚Ä¢ ¬© <span id="year"></span>
				</div>
			</aside>

			<!-- MAIN -->
			<main class="app-main">
				<div class="page-header">
					<h1>Create New Event</h1>
					<p class="text-muted mb-0">
						Fill all details carefully before submission
					</p>
				</div>

				<!-- QUICK CREATE (SIMPLE FORM) -->
				<div id="simpleFormWrapper" class="card mb-4">
					<div class="card-body">
						<h4 class="mb-2">Quick Create Event</h4>
						<p class="text-muted">
							Create a basic event quickly. You can add advanced
							settings later.
						</p>

						<form id="simpleEventForm" class="row g-3">
							<div class="col-md-8">
								<label class="form-label required"
									>Event Title</label
								>
								<input
									id="s_title"
									class="form-control"
									required
								/>
							</div>
							<div class="col-md-4">
								<label class="form-label">Event Subtitle</label>
								<input id="s_subtitle" class="form-control" />
							</div>
							<div class="col-12">
								<label class="form-label required"
									>Event Description</label
								>
								<textarea
									id="s_description"
									class="form-control"
									rows="3"
									required
								></textarea>
							</div>
							<div class="col-md-4">
								<label class="form-label required"
									>Category</label
								>
								<select
									id="s_category"
									class="form-select"
									required
								>
									<option value="">-- Select --</option>
									<option>Technical</option>
									<option>Cultural</option>
									<option>Sports</option>
									<option>Workshop</option>
									<option>Talk</option>
									<option>Competition</option>
								</select>
							</div>
							<div class="col-md-4">
								<label class="form-label required"
									>Event Type</label
								>
								<select
									id="s_eventType"
									class="form-select"
									required
								>
									<option value="">-- Select --</option>
									<option value="free">Free</option>
									<option value="paid">Paid</option>
								</select>
							</div>
							<div class="col-md-4">
								<label class="form-label required"
									>Event Mode</label
								>
								<select
									id="s_mode"
									class="form-select"
									required
								>
									<option value="">-- Select --</option>
									<option value="Online">Online</option>
									<option value="Offline">Offline</option>
									<option value="Hybrid">Hybrid</option>
								</select>
							</div>
							<div class="col-md-6">
								<label class="form-label required"
									>Start Date & Time</label
								>
								<input
									id="s_startAt"
									type="datetime-local"
									class="form-control"
									required
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label required"
									>End Date & Time</label
								>
								<input
									id="s_endAt"
									type="datetime-local"
									class="form-control"
									required
								/>
							</div>
							<div
								class="col-12 d-flex justify-content-between mt-3"
							>
								<button type="submit" class="btn btn-success">
									Create Event
								</button>
								<button
									type="button"
									class="btn btn-outline-primary"
									id="moreCustomizationBtn"
								>
									More Customization ‚Üí
								</button>
							</div>
						</form>
					</div>
				</div>

				<!-- STEPPER -->
				<div class="stepper-wrapper" style="display: none">
					<div class="stepper">
						<div class="step-item active">
							<div class="step-button">1</div>
							<div class="step-title">Basic</div>
						</div>
						<div class="step-item">
							<div class="step-button">2</div>
							<div class="step-title">Organizers</div>
						</div>
						<div class="step-item">
							<div class="step-button">3</div>
							<div class="step-title">Schedule</div>
						</div>
						<div class="step-item">
							<div class="step-button">4</div>
							<div class="step-title">Registration</div>
						</div>
						<div class="step-item">
							<div class="step-button">5</div>
							<div class="step-title">Resources</div>
						</div>
						<div class="step-item">
							<div class="step-button">6</div>
							<div class="step-title">Media</div>
						</div>
						<div class="step-item">
							<div class="step-button">7</div>
							<div class="step-title">Audience</div>
						</div>
						<div class="step-item">
							<div class="step-button">8</div>
							<div class="step-title">Registration Form</div>
						</div>
					</div>
				</div>

				<form
					id="eventForm"
					class="form-container"
					style="display: none"
				>
					<!-- STEP 1: Basic Information -->
					<div class="form-step active">
						<div class="step-header">
							<h2>
								<span class="icon">üìã</span>Basic Information
							</h2>
						</div>
						<div class="row g-3">
							<div class="col-md-8">
								<label class="form-label required"
									>Event Title</label
								>
								<input
									name="title"
									class="form-control"
									placeholder="Enter event title"
									required
								/>
								<div class="help-text">5‚Äì150 characters</div>
							</div>
							<div class="col-md-4">
								<label class="form-label">Event Subtitle</label>
								<input
									name="subtitle"
									class="form-control"
									placeholder="Optional tagline"
								/>
							</div>
							<div class="col-12">
								<label class="form-label required"
									>Event Description</label
								>
								<textarea
									name="description"
									class="form-control"
									rows="4"
									placeholder="Describe the event in detail"
									required
								></textarea>
							</div>
							<div class="col-md-4">
								<label class="form-label required"
									>Event Category</label
								>
								<select
									name="category"
									class="form-select"
									required
								>
									<option value="">
										-- Select Category --
									</option>
									<option>Technical</option>
									<option>Cultural</option>
									<option>Sports</option>
									<option>Workshop</option>
									<option>Talk</option>
									<option>Competition</option>
									<option>Festival</option>
								</select>
							</div>
							<div class="col-md-4">
								<label class="form-label required"
									>Event Type</label
								>
								<select
									id="eventType"
									name="eventType"
									class="form-select"
									required
								>
									<option value="">-- Select Type --</option>
									<option value="free">Free Entry</option>
									<option value="paid">Paid Entry</option>
								</select>
							</div>
							<div
								class="col-md-4"
								id="feeBox"
								style="display: none"
							>
								<label class="form-label"
									>Entry Fee Amount</label
								>
								<input
									type="number"
									id="entryFee"
									name="entryFee"
									class="form-control"
									placeholder="e.g. 500"
								/>
							</div>
							<div class="col-12">
								<label class="form-label"
									>Tags / Keywords</label
								>
								<input
									id="tagInput"
									class="form-control"
									placeholder="Press Enter to add tag"
								/>
								<div
									id="tagsContainer"
									class="tag-container"
								></div>
							</div>
						</div>
					</div>

					<!-- STEP 2: Organizer Details -->
					<div class="form-step">
						<div class="step-header">
							<h2>
								<span class="icon">üë•</span>Organizer Details
							</h2>
						</div>
						<div class="row g-3">
							<div class="col-md-6">
								<label class="form-label required"
									>Organizing Club / Department</label
								>
								<select
									name="organizer"
									class="form-select"
									required
								>
									<option value="">
										-- Select Organizer --
									</option>
									<option>Tech Club</option>
									<option>Cultural Club</option>
									<option>CSE Department</option>
									<option>ECE Department</option>
									<option>Other</option>
								</select>
							</div>
							<div class="col-md-6">
								<label class="form-label required"
									>Primary Coordinator</label
								>
								<input
									name="primaryCoordinator"
									class="form-control"
									placeholder="Faculty name"
									required
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label"
									>Coordinator Email</label
								>
								<input
									name="coordEmail"
									class="form-control"
									placeholder="coordinator@college.edu"
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label"
									>Coordinator Phone</label
								>
								<input
									name="coordPhone"
									class="form-control"
									placeholder="+91 98765 43210"
								/>
							</div>
						</div>
					</div>

					<!-- STEP 3: Schedule & Venue -->
					<div class="form-step">
						<div class="step-header">
							<h2>
								<span class="icon">üìÖ</span>Schedule & Venue
							</h2>
						</div>
						<div class="row g-3">
							<div class="col-md-6">
								<label class="form-label required"
									>Start Date & Time</label
								>
								<input
									type="datetime-local"
									name="startAt"
									class="form-control"
									required
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label required"
									>End Date & Time</label
								>
								<input
									type="datetime-local"
									name="endAt"
									class="form-control"
									required
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label required"
									>Event Mode</label
								>
								<select
									id="modeSelect"
									name="mode"
									class="form-select"
									required
								>
									<option value="">-- Select Mode --</option>
									<option value="Online">Online</option>
									<option value="Offline">Offline</option>
									<option value="Hybrid">Hybrid</option>
								</select>
							</div>
							<div class="col-md-6" id="venueGroup">
								<label class="form-label required"
									>Venue / Location</label
								>
								<input
									type="text"
									id="venue"
									name="venue"
									class="form-control"
									placeholder="Auditorium, Seminar Hall, Ground"
								/>
							</div>
							<div class="col-md-6" id="roomsGroup">
								<label class="form-label">Rooms / Spaces</label>
								<input
									type="text"
									id="rooms"
									name="rooms"
									class="form-control"
									placeholder="Lab, Hall, Open Ground"
								/>
							</div>
							<div
								class="col-md-6"
								id="onlineLinkGroup"
								style="display: none"
							>
								<label class="form-label"
									>Online Meeting Link</label
								>
								<input
									type="url"
									id="onlineLink"
									name="onlineLink"
									class="form-control"
									placeholder="https://meet.google.com/xyz"
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label">Recurrence</label>
								<select name="recurrence" class="form-select">
									<option value="">No Recurrence</option>
									<option>Daily</option>
									<option>Weekly</option>
									<option>Monthly</option>
								</select>
							</div>
						</div>
					</div>

					<!-- STEP 4: Registration Settings -->
					<div class="form-step">
						<div class="step-header">
							<h2>
								<span class="icon">‚úÖ</span>Registration
								Settings
							</h2>
						</div>
						<div class="row g-3">
							<div class="col-md-6">
								<label class="form-label required"
									>Registration Required?</label
								>
								<select
									name="registrationRequired"
									class="form-select"
									required
								>
									<option>Yes</option>
									<option>No</option>
								</select>
							</div>
							<div class="col-md-6">
								<label class="form-label"
									>Registration Type</label
								>
								<select
									name="registrationType"
									class="form-select"
								>
									<option>Open</option>
									<option>Invite-only</option>
									<option>Approval-based</option>
								</select>
							</div>
							<div class="col-md-6">
								<label class="form-label"
									>Registration Start</label
								>
								<input
									type="datetime-local"
									name="regStart"
									class="form-control"
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label"
									>Registration End</label
								>
								<input
									type="datetime-local"
									name="regEnd"
									class="form-control"
								/>
							</div>
							<div class="col-md-4">
								<label class="form-label"
									>Participant Limit</label
								>
								<input
									type="number"
									name="participantLimit"
									class="form-control"
									placeholder="e.g. 200"
								/>
							</div>
							<div class="col-md-4">
								<label class="form-label required"
									>Security Level</label
								>
								<select
									name="securityLevel"
									class="form-select"
									required
								>
									<option>Low</option>
									<option selected>Medium</option>
									<option>High</option>
								</select>
							</div>
							<div class="col-md-4">
								<label class="form-label"
									>Age Restriction</label
								>
								<input
									type="number"
									name="ageRestriction"
									class="form-control"
									placeholder="18"
								/>
							</div>
						</div>
					</div>

					<!-- STEP 5: Resources & Catering -->
					<div class="form-step">
						<div class="step-header">
							<h2>
								<span class="icon">üß∞</span>Resources & Catering
							</h2>
						</div>
						<div class="row g-3">
							<div class="col-md-6">
								<label class="form-label"
									>Equipment Needed</label
								>
								<input
									name="equipment"
									class="form-control"
									placeholder="Projector, Mic, Chairs"
								/>
							</div>
							<div class="col-md-3">
								<label class="form-label"
									>Catering Required?</label
								>
								<select
									id="catering"
									name="catering"
									class="form-select"
								>
									<option>No</option>
									<option>Yes</option>
								</select>
							</div>
							<div
								class="col-md-3"
								id="cateringBox"
								style="display: none"
							>
								<label class="form-label"
									>Catering Details</label
								>
								<input
									name="cateringDetails"
									class="form-control"
									placeholder="Veg / Non-veg"
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label"
									>Enable Team Participation?</label
								>
								<select
									id="teamsEnabled"
									name="teamsEnabled"
									class="form-select"
								>
									<option>No</option>
									<option>Yes</option>
								</select>
							</div>
							<div
								class="col-md-6"
								id="teamBox"
								style="display: none"
							>
								<label class="form-label">Min Team Size</label>
								<input
									name="teamMin"
									type="number"
									class="form-control"
									placeholder="2"
								/>
								<label class="form-label mt-2"
									>Max Team Size</label
								>
								<input
									name="teamMax"
									type="number"
									class="form-control"
									placeholder="5"
								/>
								<label class="form-label mt-2">Join Mode</label>
								<select name="teamJoinMode" class="form-select">
									<option>Open</option>
									<option>Invite-only</option>
									<option>Code-protected</option>
								</select>
							</div>
							<div
								class="col-md-6"
								id="feeModeBox"
								style="display: none"
							>
								<label class="form-label required"
									>Entry Fee Applies To</label
								>
								<select
									id="feeMode"
									name="feeMode"
									class="form-select"
								>
									<option value="">-- Select --</option>
									<option value="per_person">
										Per Person
									</option>
									<option value="per_team">Per Team</option>
								</select>
							</div>
						</div>
					</div>

					<!-- STEP 6: Media & Visibility -->
					<div class="form-step">
						<div class="step-header">
							<h2>
								<span class="icon">üé®</span>Media & Visibility
							</h2>
						</div>
						<div class="row g-3">
							<div class="col-md-6">
								<label class="form-label">Event Poster</label>
								<input
									type="file"
									name="poster"
									class="form-control"
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label"
									>Promo Video Link</label
								>
								<input
									name="promoVideo"
									class="form-control"
									placeholder="YouTube / Drive link"
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label"
									>Documents (PDF)</label
								>
								<input
									type="file"
									name="documents"
									class="form-control"
									multiple
								/>
							</div>
							<div class="col-md-6">
								<label class="form-label required"
									>Visibility</label
								>
								<select
									name="visibility"
									class="form-select"
									required
								>
									<option>Public</option>
									<option>Campus-only</option>
									<option>Department-only</option>
									<option>Private</option>
								</select>
							</div>
						</div>
					</div>

					<!-- STEP 7: Target Audience -->
					<div class="form-step">
						<div class="step-header">
							<h2><span class="icon">üéØ</span>Target Audience</h2>
						</div>
						<div class="row g-3">
							<div class="col-12">
								<label class="form-label"
									>Who is this event for?</label
								>
								<p class="text-muted small">
									Select the target audience criteria for your
									event
								</p>
							</div>
							<div class="col-md-4">
								<div class="card">
									<div class="card-body">
										<label class="form-label"
											>Audience Role</label
										>
										<div class="form-check">
											<input
												class="form-check-input"
												type="checkbox"
												name="audienceRole"
												value="students"
												id="roleStudents"
											/>
											<label
												class="form-check-label"
												for="roleStudents"
												>Students</label
											>
										</div>
										<div class="form-check">
											<input
												class="form-check-input"
												type="checkbox"
												name="audienceRole"
												value="faculty"
												id="roleFaculty"
											/>
											<label
												class="form-check-label"
												for="roleFaculty"
												>Faculty</label
											>
										</div>
										<div class="form-check">
											<input
												class="form-check-input"
												type="checkbox"
												name="audienceRole"
												value="staff"
												id="roleStaff"
											/>
											<label
												class="form-check-label"
												for="roleStaff"
												>Staff</label
											>
										</div>
										<div class="form-check">
											<input
												class="form-check-input"
												type="checkbox"
												name="audienceRole"
												value="external"
												id="roleExternal"
											/>
											<label
												class="form-check-label"
												for="roleExternal"
												>External Guests</label
											>
										</div>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="card">
									<div class="card-body">
										<label class="form-label">Course</label>
										<select
											name="audienceCourse"
											class="form-select"
										>
											<option value="">
												All Courses
											</option>
											<option value="btech">
												B.Tech
											</option>
											<option value="bca">BCA</option>
											<option value="bpharma">
												B.Pharmacy
											</option>
											<option value="mba">MBA</option>
											<option value="mca">MCA</option>
											<option value="other">Other</option>
										</select>
										<label class="form-label mt-3"
											>Branch / Department</label
										>
										<select
											name="audienceDepartment"
											class="form-select"
										>
											<option value="">
												All Departments
											</option>
											<option value="cse">
												Computer Science
											</option>
											<option value="ece">
												Electronics
											</option>
											<option value="me">
												Mechanical
											</option>
											<option value="ce">Civil</option>
											<option value="ee">
												Electrical
											</option>
										</select>
									</div>
								</div>
							</div>
							<div class="col-md-4">
								<div class="card">
									<div class="card-body">
										<label class="form-label"
											>Student Year</label
										>
										<div class="form-check">
											<input
												class="form-check-input"
												type="checkbox"
												name="audienceYear"
												value="1"
												id="year1"
											/>
											<label
												class="form-check-label"
												for="year1"
												>1st Year</label
											>
										</div>
										<div class="form-check">
											<input
												class="form-check-input"
												type="checkbox"
												name="audienceYear"
												value="2"
												id="year2"
											/>
											<label
												class="form-check-label"
												for="year2"
												>2nd Year</label
											>
										</div>
										<div class="form-check">
											<input
												class="form-check-input"
												type="checkbox"
												name="audienceYear"
												value="3"
												id="year3"
											/>
											<label
												class="form-check-label"
												for="year3"
												>3rd Year</label
											>
										</div>
										<div class="form-check">
											<input
												class="form-check-input"
												type="checkbox"
												name="audienceYear"
												value="4"
												id="year4"
											/>
											<label
												class="form-check-label"
												for="year4"
												>4th Year</label
											>
										</div>
									</div>
								</div>
							</div>
							<div class="col-12">
								<div class="alert alert-info">
									<strong>üí° Tip:</strong> Leave options
									unselected to target all users in that
									category.
								</div>
							</div>
						</div>
					</div>

					<!-- STEP 8: Registration Form Builder -->
					<div class="form-step">
						<div class="step-header">
							<h2>
								<span class="icon">üìù</span>Registration Form
								Builder
							</h2>
							<p class="text-muted">
								Define what additional information participants
								must provide while registering.
							</p>
						</div>

						<!-- System Fields -->
						<div class="card mb-3">
							<div class="card-body">
								<h6>Mandatory System Fields</h6>
								<div class="form-check">
									<input
										class="form-check-input"
										checked
										disabled
									/>
									<label class="form-check-label"
										>Full Name</label
									>
								</div>
								<div class="form-check">
									<input
										class="form-check-input"
										checked
										disabled
									/>
									<label class="form-check-label"
										>Email</label
									>
								</div>
								<div class="form-check">
									<input
										class="form-check-input"
										checked
										disabled
									/>
									<label class="form-check-label"
										>Phone Number</label
									>
								</div>
							</div>
						</div>

						<!-- Controls -->
						<div class="d-flex gap-2 mb-3">
							<button
								type="button"
								class="btn btn-primary btn-sm"
								id="addFieldBtn"
							>
								‚ûï Add Field
							</button>
							<select
								id="fieldTemplate"
								class="form-select form-select-sm"
								style="width: 220px"
							>
								<option value="">Use Template</option>
								<option value="hackathon">Hackathon</option>
								<option value="workshop">Workshop</option>
								<option value="cultural">Cultural Event</option>
							</select>
						</div>

						<!-- Fields Container -->
						<div id="customFieldsContainer"></div>

						<!-- Preview -->
						<div class="card mt-4">
							<div class="card-body">
								<h6>üëÅ Registration Form Preview</h6>
								<div
									id="registrationPreview"
									class="border rounded p-3 bg-light"
								></div>
							</div>
						</div>
					</div>

					<!-- Navigation -->
					<div class="form-navigation">
						<button
							type="button"
							class="btn btn-secondary"
							id="prevBtn"
						>
							Previous
						</button>
						<div class="ms-auto d-flex gap-2">
							<button
								type="button"
								class="btn btn-primary"
								id="nextBtn"
							>
								Next
							</button>
							<button
								type="submit"
								class="btn btn-success"
								id="submitBtn"
								style="display: none"
							>
								Create Event
							</button>
						</div>
					</div>
				</form>
			</main>
		</div>

		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
		<script>
			let isAdvancedUnlocked = false;
			let currentStep = 0;
			let registrationSchema = [];
			let fieldIdCounter = 1;

			// Simple Form Elements
			const simpleForm = document.getElementById("simpleEventForm");
			const simpleWrapper = document.getElementById("simpleFormWrapper");
			const moreCustomizationBtn = document.getElementById(
				"moreCustomizationBtn"
			);

			// Advanced Form Elements
			const stepperWrapper = document.querySelector(".stepper-wrapper");
			const eventForm = document.getElementById("eventForm");
			const steps = [...document.querySelectorAll(".form-step")];
			const stepItems = [...document.querySelectorAll(".step-item")];
			const prevBtn = document.getElementById("prevBtn");
			const nextBtn = document.getElementById("nextBtn");
			const submitBtn = document.getElementById("submitBtn");

			// Field Elements
			const tagInput = document.getElementById("tagInput");
			const tagsContainer = document.getElementById("tagsContainer");
			const eventType = document.getElementById("eventType");
			const feeBox = document.getElementById("feeBox");
			const entryFee = document.getElementById("entryFee");
			const catering = document.getElementById("catering");
			const cateringBox = document.getElementById("cateringBox");
			const teamsEnabled = document.getElementById("teamsEnabled");
			const teamBox = document.getElementById("teamBox");
			const feeModeBox = document.getElementById("feeModeBox");
			const feeMode = document.getElementById("feeMode");
			const modeSelect = document.getElementById("modeSelect");
			const venueGroup = document.getElementById("venueGroup");
			const roomsGroup = document.getElementById("roomsGroup");
			const onlineLinkGroup = document.getElementById("onlineLinkGroup");
			const venue = document.getElementById("venue");
			const onlineLink = document.getElementById("onlineLink");

			// Registration Form Builder Elements
			const addFieldBtn = document.getElementById("addFieldBtn");
			const fieldTemplate = document.getElementById("fieldTemplate");
			const customFieldsContainer = document.getElementById(
				"customFieldsContainer"
			);
			const registrationPreview = document.getElementById(
				"registrationPreview"
			);

			// ========================================
			// INITIALIZATION
			// ========================================
			document.getElementById("year").textContent =
				new Date().getFullYear();

			// Check if edit mode
			const urlParams = new URLSearchParams(window.location.search);
			const isEditMode = urlParams.get("mode") === "edit";
			const editEventId = urlParams.get("id");

			if (isEditMode && editEventId) {
				initEditMode();
			}

			// ========================================
			// SIMPLE FORM HANDLERS
			// ========================================
			function getSimpleFormData() {
				return {
					title: document.getElementById("s_title").value,
					subtitle: document.getElementById("s_subtitle").value,
					description: document.getElementById("s_description").value,
					category: document.getElementById("s_category").value,
					eventType: document.getElementById("s_eventType").value,
					mode: document.getElementById("s_mode").value,
					startAt: document.getElementById("s_startAt").value,
					endAt: document.getElementById("s_endAt").value,
				};
			}

			simpleForm.addEventListener("submit", (e) => {
				e.preventDefault();
				const data = getSimpleFormData();

				// Validate dates
				if (new Date(data.startAt) >= new Date(data.endAt)) {
					showToast("End date must be after start date", "warning");

					return;
				}

				console.log("Quick Event Created:", data);
				showToast("Quick event created successfully!", "success");

				// In production, send to API:
				// fetch('/api/events', { method: 'POST', body: JSON.stringify(data) })
			});

			moreCustomizationBtn.addEventListener("click", () => {
				const data = getSimpleFormData();

				// Save draft to localStorage
				localStorage.setItem("draftEvent", JSON.stringify(data));

				// Hide simple form, show advanced
				simpleWrapper.style.display = "none";
				stepperWrapper.style.display = "block";
				eventForm.style.display = "block";

				// Unlock and prefill
				isAdvancedUnlocked = true;
				unlockAdvancedForm();
				prefillAdvancedForm(data);
				showStep(0);
			});

			// ========================================
			// ADVANCED FORM - PREFILL & UNLOCK
			// ========================================
			function prefillAdvancedForm(data) {
				if (!data) return;

				const fields = {
					title: data.title || "",
					subtitle: data.subtitle || "",
					description: data.description || "",
					category: data.category || "",
					eventType: data.eventType || "",
					mode: data.mode || "",
					startAt: data.startAt || "",
					endAt: data.endAt || "",
				};

				Object.entries(fields).forEach(([name, value]) => {
					const el = eventForm.querySelector(`[name="${name}"]`);
					if (el) el.value = value;
				});

				// Trigger change events for dependent fields
				eventType.dispatchEvent(new Event("change"));
				modeSelect.dispatchEvent(new Event("change"));
			}

			function unlockAdvancedForm() {
				eventForm
					.querySelectorAll("input, select, textarea, button")
					.forEach((el) => {
						el.disabled = false;
					});
			}

			function lockAdvancedForm() {
				eventForm
					.querySelectorAll("input, select, textarea, button")
					.forEach((el) => {
						if (el.id !== "prevBtn" && el.id !== "nextBtn") {
							el.disabled = true;
						}
					});
			}

			// ========================================
			// STEPPER NAVIGATION
			// ========================================
			function showStep(i) {
				steps.forEach((s) => s.classList.remove("active"));
				stepItems.forEach((s, idx) => {
					s.classList.toggle("active", idx === i);
					s.classList.toggle("completed", idx < i);
				});
				steps[i].classList.add("active");

				prevBtn.style.display = i === 0 ? "none" : "inline-block";
				nextBtn.style.display =
					i === steps.length - 1 ? "none" : "inline-block";
				submitBtn.style.display =
					i === steps.length - 1 ? "inline-block" : "none";

				window.scrollTo({ top: 0, behavior: "smooth" });
			}

			nextBtn.addEventListener("click", () => {
				if (validateCurrentStep()) {
					if (currentStep < steps.length - 1) {
						currentStep++;
						showStep(currentStep);
					}
				}
			});

			prevBtn.addEventListener("click", () => {
				if (currentStep > 0) {
					currentStep--;
					showStep(currentStep);
				}
			});

			function validateCurrentStep() {
				const currentStepEl = steps[currentStep];
				const requiredInputs =
					currentStepEl.querySelectorAll("[required]");

				for (let input of requiredInputs) {
					if (!input.value.trim()) {
						input.focus();
						showToast(
							`Please fill in: ${
								input.previousElementSibling?.textContent ||
								"this field"
							}`,
							"warning"
						);

						return false;
					}
				}

				// Date validation for schedule step
				if (currentStep === 2) {
					const startAt =
						eventForm.querySelector('[name="startAt"]').value;
					const endAt =
						eventForm.querySelector('[name="endAt"]').value;

					if (new Date(startAt) >= new Date(endAt)) {
						showToast(
							"End date must be after start date",
							"warning"
						);
						return false;
					}
				}

				return true;
			}

			// ========================================
			// DYNAMIC FIELD HANDLERS
			// ========================================

			// Event Type - Show/Hide Fee Box
			eventType.addEventListener("change", (e) => {
				if (e.target.value === "paid") {
					feeBox.style.display = "block";
					entryFee.setAttribute("required", "required");
				} else {
					feeBox.style.display = "none";
					entryFee.removeAttribute("required");
					entryFee.value = "";
				}
				updateFeeModeVisibility();
			});

			// Catering - Show/Hide Details
			catering.addEventListener("change", (e) => {
				cateringBox.style.display =
					e.target.value === "Yes" ? "block" : "none";
			});

			// Teams - Show/Hide Team Settings
			teamsEnabled.addEventListener("change", (e) => {
				teamBox.style.display =
					e.target.value === "Yes" ? "block" : "none";
				updateFeeModeVisibility();
			});

			// Fee Mode Visibility
			function updateFeeModeVisibility() {
				if (
					eventType.value === "paid" &&
					teamsEnabled.value === "Yes"
				) {
					feeModeBox.style.display = "block";
					feeMode.setAttribute("required", "required");
				} else {
					feeModeBox.style.display = "none";
					feeMode.removeAttribute("required");
					feeMode.value = "";
				}
			}

			// Event Mode - Show/Hide Venue/Online
			modeSelect.addEventListener("change", (e) => {
				const mode = e.target.value;

				if (mode === "Online") {
					venueGroup.style.display = "none";
					roomsGroup.style.display = "none";
					onlineLinkGroup.style.display = "block";
					venue.removeAttribute("required");
					venue.value = "";
					onlineLink.setAttribute("required", "required");
				} else if (mode === "Offline") {
					venueGroup.style.display = "block";
					roomsGroup.style.display = "block";
					onlineLinkGroup.style.display = "none";
					venue.setAttribute("required", "required");
					onlineLink.removeAttribute("required");
					onlineLink.value = "";
				} else if (mode === "Hybrid") {
					venueGroup.style.display = "block";
					roomsGroup.style.display = "block";
					onlineLinkGroup.style.display = "block";
					venue.setAttribute("required", "required");
					onlineLink.setAttribute("required", "required");
				}
			});

			// Tag Management
			tagInput.addEventListener("keydown", (e) => {
				if (e.key === "Enter") {
					e.preventDefault();
					const tagValue = tagInput.value.trim();
					if (tagValue) {
						const tag = document.createElement("div");
						tag.className = "tag";
						tag.innerHTML = `${tagValue} <span class="remove">√ó</span>`;
						tag.querySelector(".remove").addEventListener(
							"click",
							() => tag.remove()
						);
						tagsContainer.appendChild(tag);
						tagInput.value = "";
					}
				}
			});

			// ========================================
			// REGISTRATION FORM BUILDER
			// ========================================

			// Field Templates
			const templates = {
				hackathon: [
					{
						label: "College/University",
						type: "text",
						required: true,
					},
					{ label: "Team Name", type: "text", required: true },
					{ label: "GitHub Profile", type: "url", required: false },
					{
						label: "Project Idea (Brief)",
						type: "textarea",
						required: true,
					},
				],
				workshop: [
					{
						label: "Current Skill Level",
						type: "select",
						options: ["Beginner", "Intermediate", "Advanced"],
						required: true,
					},
					{
						label: "Why do you want to attend?",
						type: "textarea",
						required: true,
					},
					{
						label: "Dietary Preferences",
						type: "select",
						options: ["Veg", "Non-veg", "Vegan"],
						required: false,
					},
				],
				cultural: [
					{
						label: "Performance Category",
						type: "select",
						options: ["Solo", "Group", "Duo"],
						required: true,
					},
					{
						label: "Performance Duration (mins)",
						type: "number",
						required: true,
					},
					{
						label: "Special Requirements",
						type: "textarea",
						required: false,
					},
				],
			};

			// Add Field Button
			addFieldBtn.addEventListener("click", () => {
				addCustomField({
					label: "Custom Field",
					type: "text",
					required: false,
					options: [],
				});
				updatePreview();
			});

			// Template Selection
			fieldTemplate.addEventListener("change", (e) => {
				const templateName = e.target.value;
				if (templateName && templates[templateName]) {
					registrationSchema = [];
					customFieldsContainer.innerHTML = "";

					templates[templateName].forEach((field) => {
						addCustomField(field);
					});

					updatePreview();
					fieldTemplate.value = "";
				}
			});

			// Add Custom Field
			function addCustomField(field) {
				const fieldId = `field_${fieldIdCounter++}`;
				registrationSchema.push({ ...field, id: fieldId });

				const fieldCard = document.createElement("div");
				fieldCard.className = "card mb-2";
				fieldCard.innerHTML = `
		<div class="card-body">
			<div class="row g-2">
				<div class="col-md-4">
					<input type="text" class="form-control form-control-sm" 
						placeholder="Field Label" value="${field.label}" 
						data-field-id="${fieldId}" data-prop="label" />
				</div>
				<div class="col-md-3">
					<select class="form-select form-select-sm" 
						data-field-id="${fieldId}" data-prop="type">
						<option value="text" ${field.type === "text" ? "selected" : ""}>Text</option>
						<option value="email" ${field.type === "email" ? "selected" : ""}>Email</option>
						<option value="number" ${
							field.type === "number" ? "selected" : ""
						}>Number</option>
						<option value="tel" ${field.type === "tel" ? "selected" : ""}>Phone</option>
						<option value="url" ${field.type === "url" ? "selected" : ""}>URL</option>
						<option value="date" ${field.type === "date" ? "selected" : ""}>Date</option>
						<option value="textarea" ${
							field.type === "textarea" ? "selected" : ""
						}>Long Text</option>
						<option value="select" ${
							field.type === "select" ? "selected" : ""
						}>Dropdown</option>
						<option value="checkbox" ${
							field.type === "checkbox" ? "selected" : ""
						}>Checkbox</option>
						<option value="file" ${
							field.type === "file" ? "selected" : ""
						}>File Upload</option>
					</select>
				</div>
				<div class="col-md-3 options-box" style="display: ${
					field.type === "select" ? "block" : "none"
				}">
					<input type="text" class="form-control form-control-sm" 
						placeholder="Options (comma-sep)" 
						value="${field.options?.join(", ") || ""}"
						data-field-id="${fieldId}" data-prop="options" />
				</div>
				<div class="col-md-2">
					<div class="form-check">
						<input class="form-check-input" type="checkbox" 
							${field.required ? "checked" : ""}
							data-field-id="${fieldId}" data-prop="required" />
						<label class="form-check-label small">Required</label>
					</div>
				</div>
				<div class="col-12">
					<button type="button" class="btn btn-danger btn-sm" 
						onclick="removeField('${fieldId}')">üóë Remove</button>
				</div>
			</div>
		</div>
	`;

				customFieldsContainer.appendChild(fieldCard);

				// Add event listeners
				fieldCard
					.querySelectorAll("[data-field-id]")
					.forEach((input) => {
						input.addEventListener("change", (e) =>
							updateFieldProperty(e.target)
						);
						input.addEventListener("input", (e) =>
							updateFieldProperty(e.target)
						);
					});
			}

			// Update Field Property
			function updateFieldProperty(input) {
				const fieldId = input.dataset.fieldId;
				const prop = input.dataset.prop;
				const field = registrationSchema.find((f) => f.id === fieldId);

				if (!field) return;

				if (prop === "required") {
					field[prop] = input.checked;
				} else if (prop === "options") {
					field[prop] = input.value
						.split(",")
						.map((s) => s.trim())
						.filter(Boolean);
				} else if (prop === "type") {
					field[prop] = input.value;

					// Show/hide options box
					const card = input.closest(".card-body");
					const optionsBox = card.querySelector(".options-box");
					if (optionsBox) {
						optionsBox.style.display =
							input.value === "select" ? "block" : "none";
					}
				} else {
					field[prop] = input.value;
				}

				updatePreview();
			}

			// Remove Field
			function removeField(fieldId) {
				registrationSchema = registrationSchema.filter(
					(f) => f.id !== fieldId
				);
				const card = document
					.querySelector(`[data-field-id="${fieldId}"]`)
					?.closest(".card");
				if (card) card.remove();
				updatePreview();
			}
			window.removeField = removeField; // Make global for inline onclick

			// Update Preview
			function updatePreview() {
				registrationPreview.innerHTML = `
		<div class="mb-2"><strong>Full Name *</strong><br/><input class="form-control form-control-sm" disabled /></div>
		<div class="mb-2"><strong>Email *</strong><br/><input class="form-control form-control-sm" disabled /></div>
		<div class="mb-2"><strong>Phone Number *</strong><br/><input class="form-control form-control-sm" disabled /></div>
		${registrationSchema
			.map((field) => {
				const req = field.required ? " *" : "";
				if (field.type === "textarea") {
					return `<div class="mb-2"><strong>${field.label}${req}</strong><br/><textarea class="form-control form-control-sm" rows="2" disabled></textarea></div>`;
				} else if (field.type === "select") {
					return `<div class="mb-2"><strong>${
						field.label
					}${req}</strong><br/><select class="form-select form-select-sm" disabled><option>-- Select --</option>${
						field.options
							?.map((o) => `<option>${o}</option>`)
							.join("") || ""
					}</select></div>`;
				} else if (field.type === "checkbox") {
					return `<div class="mb-2"><input type="checkbox" disabled /> <strong>${field.label}${req}</strong></div>`;
				} else if (field.type === "file") {
					return `<div class="mb-2"><strong>${field.label}${req}</strong><br/><input type="file" class="form-control form-control-sm" disabled /></div>`;
				} else {
					return `<div class="mb-2"><strong>${field.label}${req}</strong><br/><input type="${field.type}" class="form-control form-control-sm" disabled /></div>`;
				}
			})
			.join("")}
	`;
			}

			// ========================================
			// FORM SUBMISSION
			// ========================================
			eventForm.addEventListener("submit", (e) => {
				e.preventDefault();

				const formData = new FormData(eventForm);
				const eventData = Object.fromEntries(formData.entries());

				// Collect tags
				const tags = [...tagsContainer.querySelectorAll(".tag")].map(
					(tag) => tag.textContent.replace("√ó", "").trim()
				);

				// Collect audience checkboxes
				const audienceRoles = [
					...eventForm.querySelectorAll(
						'[name="audienceRole"]:checked'
					),
				].map((cb) => cb.value);
				const audienceYears = [
					...eventForm.querySelectorAll(
						'[name="audienceYear"]:checked'
					),
				].map((cb) => cb.value);

				const finalPayload = {
					...eventData,
					tags,
					audienceRoles,
					audienceYears,
					registrationSchema,
					createdAt: new Date().toISOString(),
					status: "draft",
				};

				console.log("üéâ Event Created:", finalPayload);
				showToast("Event created successfully", "success");
				window.location.href = "events.html";

				// In production:
				// fetch('/api/events', { method: 'POST', body: JSON.stringify(finalPayload) })
				//   .then(() => window.location.href = 'events.html')
			});

			// ========================================
			// EDIT MODE
			// ========================================
			async function initEditMode() {
				const eventData = await fetchEventById(editEventId);

				// Hide simple form
				simpleWrapper.style.display = "none";
				stepperWrapper.style.display = "block";
				eventForm.style.display = "block";

				// Unlock and prefill
				isAdvancedUnlocked = true;
				unlockAdvancedForm();
				prefillAdvancedForm(eventData);

				// Prefill registration schema
				if (eventData.registrationSchema) {
					registrationSchema = eventData.registrationSchema;
					customFieldsContainer.innerHTML = "";
					eventData.registrationSchema.forEach((field) =>
						addCustomField(field)
					);
					updatePreview();
				}

				showStep(0);
			}

			async function fetchEventById(eventId) {
				// Mock data - replace with real API call
				return {
					title: "Ideathon 2025",
					subtitle: "Innovate. Build. Win.",
					description: "24-hour ideathon event",
					category: "Technical",
					eventType: "paid",
					mode: "Offline",
					startAt: "2025-03-10T10:00",
					endAt: "2025-03-11T10:00",
					venue: "Main Auditorium",
					entryFee: 200,
					teamsEnabled: "Yes",
					teamMin: 2,
					teamMax: 4,
					registrationSchema: [
						{
							label: "College Name",
							type: "text",
							required: true,
							id: "field_1",
						},
					],
				};
			}

			// ========================================
			// LOGOUT HANDLERS
			// ========================================
			document
				.getElementById("logoutBtn")
				.addEventListener("click", (e) => {
					e.preventDefault();
					if (confirm("Are you sure you want to logout?")) {
						window.location.href = "login.html";
					}
				});

			document
				.getElementById("logoutSide")
				.addEventListener("click", (e) => {
					e.preventDefault();
					if (confirm("Are you sure you want to logout?")) {
						window.location.href = "login.html";
					}
				});
			function showToast(message, type = "success") {
				const toastEl = document.getElementById("appToast");
				const toastMsg = document.getElementById("toastMessage");

				toastMsg.textContent = message;

				// Reset classes
				toastEl.className = "toast align-items-center border-0";

				// Apply type
				switch (type) {
					case "success":
						toastEl.classList.add("text-bg-success");
						break;
					case "error":
						toastEl.classList.add("text-bg-danger");
						break;
					case "warning":
						toastEl.classList.add("text-bg-warning");
						break;
					case "info":
						toastEl.classList.add("text-bg-primary");
						break;
				}

				const toast = new bootstrap.Toast(toastEl, { delay: 3000 });
				toast.show();
			}

			// Initialize
			showStep(0);
			updatePreview();
		</script>
		<!-- Toast Container -->
		<div
			class="toast-container position-fixed top-0 end-0 p-3"
			style="z-index: 1080"
		>
			<div
				id="appToast"
				class="toast align-items-center text-bg-success border-0"
				role="alert"
				aria-live="assertive"
				aria-atomic="true"
			>
				<div class="d-flex">
					<div class="toast-body" id="toastMessage">Message here</div>
					<button
						type="button"
						class="btn-close btn-close-white me-2 m-auto"
						data-bs-dismiss="toast"
						aria-label="Close"
					></button>
				</div>
			</div>
		</div>
	</body>
</html>
