<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Event Ease ‚Äî Profile (Student)</title>

    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../style.css" />

    <style>
      body {
        font-family: Inter, system-ui, Arial;
        background: var(--bg-light);
        color: var(--text-dark);
      }
      .app-shell {
        display: flex;
        min-height: calc(100vh - var(--header-height));
      }
      .app-sidebar {
        width: var(--sidebar-width);
        background: linear-gradient(180deg, var(--sidebar-gradient-start), var(--sidebar-gradient-end));
        color: #fff;
        padding: 28px 20px;
        display: flex;
        flex-direction: column;
        box-shadow: var(--shadow-md);
      }
      .app-main {
        flex: 1;
        padding: 32px;
        background: var(--bg-light);
      }
      @media (max-width: 991px) {
        .app-sidebar {
          display: none;
        }
        .app-main {
          padding: 24px 16px;
        }
      }

      /* Page header aligned with other pages */
      .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
      }
      .page-title {
        font-size: 1.6rem;
        font-weight: 800;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }
      .page-subtitle {
        font-size: 0.95rem;
        color: #6b7280;
      }

      .profile-wrapper {
        max-width: 900px;
        margin: 0 auto;
      }

      .profile-card {
        background: #fff;
        border-radius: 16px;
        padding: 24px;
        border: 1px solid #e5e7eb;
        box-shadow: 0 12px 30px rgba(0,0,0,0.06);
      }

      .profile-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 16px;
        margin-bottom: 20px;
      }

      .avatar {
        width: 110px;
        height: 110px;
        border-radius: 50%;
        background: linear-gradient(135deg, #4f46e5, #3b82f6);
        color: white;
        font-size: 42px;
        font-weight: 700;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 15px 30px rgba(37,99,235,0.5);
      }

      .profile-header-info h4 {
        margin-bottom: 4px;
      }

      .profile-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 10px;
        border-radius: 999px;
        background: #eef2ff;
        color: #4f46e5;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
      }

      .info-box {
        padding: 12px 14px;
        border-radius: 10px;
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        margin-bottom: 10px;
      }

      .label {
        font-size: 12px;
        color: #6b7280;
        font-weight: 600;
      }

      .value {
        font-size: 15px;
        font-weight: 600;
      }

      .value input.form-control-sm {
        font-size: 14px;
        font-weight: 500;
      }

      .stat-box {
        text-align: center;
        padding: 14px;
        border-radius: 12px;
        background: #eef2ff;
        font-weight: 700;
        box-shadow: 0 10px 24px rgba(129,140,248,0.25);
      }

      .stat-box div:last-child {
        font-size: 22px;
      }

      .profile-actions {
        margin-top: 16px;
        text-align: right;
      }

      .profile-actions .btn {
        border-radius: 999px;
      }

      .last-updated {
        font-size: 0.8rem;
        color: #6b7280;
      }
    </style>
  </head>

  <body>
    <header class="topbar">
      <a
        href="user-home.html"
        class="d-flex align-items-center text-decoration-none"
      >
        <div class="logo-mark">EE</div>
        <div style="margin-left: 10px; font-weight: 700; color: var(--text-dark);">
          Event Ease
        </div>
      </a>
    </header>

    <div class="app-shell">
      <aside class="app-sidebar d-none d-lg-flex">
        <nav class="sidebar-nav">
          <a href="user-home.html">üè† Home</a>
          <a href="user-events.html">üìÖ Browse Events</a>
          <a href="user-registrations.html">üìã My Registrations</a>
          <a href="user-notification.html">üîî Notifications</a>
          <a href="user-profile.html" class="active">üë§ Profile</a>
        </nav>
      </aside>

      <main class="app-main">
        <div class="profile-wrapper">
          <div class="page-header">
            <div>
              <div class="page-title">My Profile</div>
              <div class="page-subtitle">Manage your student account details.</div>
            </div>
          </div>

          <div class="profile-card">
            <!-- HEADER -->
            <div class="profile-header">
              <div class="profile-header-info">
                <h4 class="mb-1" id="profileNameHeading">Student Name</h4>
                <div class="text-muted mb-1">Student Account</div>
                <div class="profile-badge">
                  <span>üéì Student</span>
                  <span id="profileDeptBadge">Computer Science</span>
                </div>
              </div>
              <div class="avatar">ST</div>
            </div>

            <!-- BASIC INFO -->
            <div class="row">
              <div class="col-md-6">
                <div class="info-box">
                  <div class="label">Full Name</div>
                  <div class="value">Student Name</div>
                </div>

                <div class="info-box">
                  <div class="label">Email</div>
                  <div class="value">student@college.edu</div>
                </div>

                <div class="info-box">
                  <div class="label">Roll Number</div>
                  <div class="value">CS2025-001</div>
                </div>
              </div>

              <div class="col-md-6">
                <div class="info-box">
                  <div class="label">Department</div>
                  <div class="value">Computer Science</div>
                </div>

                <div class="info-box">
                  <div class="label">Year</div>
                  <div class="value">3rd Year</div>
                </div>

                <div class="info-box">
                  <div class="label">Phone</div>
                  <div class="value">+91 XXXXXXXX</div>
                </div>
              </div>
            </div>

            <!-- STATS -->
            <div class="row mt-4 g-3">
              <div class="col-md-4">
                <div class="stat-box">
                  <div>Registered Events</div>
                  <div id="statRegistered">5</div>
                </div>
              </div>

              <div class="col-md-4">
                <div class="stat-box">
                  <div>Approved</div>
                  <div id="statApproved">3</div>
                </div>
              </div>

              <div class="col-md-4">
                <div class="stat-box">
                  <div>Pending</div>
                  <div id="statPending">2</div>
                </div>
              </div>
            </div>

            <div class="d-flex justify-content-between align-items-center mt-3">
              <div class="last-updated">
                Last updated: <span id="lastUpdated">Not updated yet</span>
              </div>
              <div class="profile-actions">
                <button class="btn btn-outline-primary me-2" onclick="enableEdit()">
                  Edit Profile
                </button>
                <button class="btn btn-danger" onclick="logout()">
                  Logout
                </button>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      /* PROFILE STORAGE */
      const defaultProfile = {
        name: "Student Name",
        email: "student@college.edu",
        roll: "CS2025-001",
        dept: "Computer Science",
        year: "3rd Year",
        phone: "+91 XXXXXXXX",
        lastUpdated: null,
        stats: { registered: 5, approved: 3, pending: 2 }
      };

      let profile =
        JSON.parse(localStorage.getItem("studentProfile")) ||
        defaultProfile;

      const fields = {
        name: 0,
        email: 1,
        roll: 2,
        dept: 3,
        year: 4,
        phone: 5,
      };

      /* LOAD PROFILE INTO UI */
      function loadProfile() {
        const values = document.querySelectorAll(".info-box .value");

        values[fields.name].innerText = profile.name;
        values[fields.email].innerText = profile.email;
        values[fields.roll].innerText = profile.roll;
        values[fields.dept].innerText = profile.dept;
        values[fields.year].innerText = profile.year;
        values[fields.phone].innerText = profile.phone;

        // Avatar initials
        document.querySelector(".avatar").innerText =
          profile.name
            .split(" ")
            .map((x) => x[0])
            .join("")
            .slice(0, 2)
            .toUpperCase();

        // Header name & badge
        document.getElementById("profileNameHeading").innerText = profile.name;
        document.getElementById("profileDeptBadge").innerText = profile.dept;

        // Stats
        document.getElementById("statRegistered").innerText = profile.stats?.registered ?? 0;
        document.getElementById("statApproved").innerText = profile.stats?.approved ?? 0;
        document.getElementById("statPending").innerText = profile.stats?.pending ?? 0;

        // Last updated
        const updatedLabel = document.getElementById("lastUpdated");
        if (profile.lastUpdated) {
          updatedLabel.innerText = new Date(profile.lastUpdated).toLocaleString();
        } else {
          updatedLabel.innerText = "Not updated yet";
        }
      }

      /* ENABLE EDIT */
      function enableEdit() {
        document.querySelectorAll(".info-box .value").forEach((el) => {
          const text = el.innerText;
          el.innerHTML = `<input class="form-control form-control-sm" value="${text}">`;
        });

        document.querySelector(".profile-actions").innerHTML = `
          <button class="btn btn-success me-2" onclick="saveProfile()">Save</button>
          <button class="btn btn-secondary" onclick="cancelEdit()">Cancel</button>
        `;
      }

      /* SAVE PROFILE */
      function saveProfile() {
        const inputs = document.querySelectorAll(".info-box input");

        profile = {
          ...profile,
          name: inputs[fields.name].value,
          email: inputs[fields.email].value,
          roll: inputs[fields.roll].value,
          dept: inputs[fields.dept].value,
          year: inputs[fields.year].value,
          phone: inputs[fields.phone].value,
          lastUpdated: new Date().toISOString()
        };

        localStorage.setItem("studentProfile", JSON.stringify(profile));

        alert("Profile updated successfully");
        restoreView();
      }

      /* CANCEL EDIT */
      function cancelEdit() {
        restoreView();
      }

      /* RESTORE VIEW MODE */
      function restoreView() {
        document.querySelector(".profile-actions").innerHTML = `
          <button class="btn btn-outline-primary me-2" onclick="enableEdit()">Edit Profile</button>
          <button class="btn btn-danger" onclick="logout()">Logout</button>
        `;
        loadProfile();
      }

      /* LOGOUT */
      function logout() {
        if (!confirm("Are you sure you want to logout?")) return;
        localStorage.removeItem("studentSession");
        window.location.href = "../login.html";
      }

      loadProfile();
    </script>
  </body>
</html>
